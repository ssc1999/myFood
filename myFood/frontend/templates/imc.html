<!DOCTYPE html>
<html lang="en">

<head>
	<title>myFood</title>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="icon" type="image/png" href="../images/icons/favicon.ico" />
	<link rel="stylesheet" type="text/css" href="../vendor/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css"
		href="../fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="../vendor/animate/animate.css">
	<link rel="stylesheet" type="text/css" href="../vendor/css-hamburgers/hamburgers.min.css">
	<link rel="stylesheet" type="text/css" href="../vendor/select2/select2.min.css">
	<link rel="stylesheet" type="text/css" href="../css/util.css">
	<link rel="stylesheet" type="text/css" href="../css/main.css">

</head>

<body>
	<div class="limiter">
		<div class="container-index">
			<div class="white-box">
				<h2>Calculate your BMI!</h2>
				<form class="imc-form" id="myForm">
					<div class="form-line">
						<label>Height:</label>
						<input type="text" id="height" placeholder="cm" class="box" />
					</div>
					<div class="form-line">
						<label>Weight:</label>
						<input type="text" id="weight" placeholder="kg" class="box" />
					</div>
					<div class="form-line">
						<label>Age:</label>
						<input type="text" id="age" placeholder="" class="box" />
					</div>
					<div class="form-line" id="sex-radio">
						<div>
							<label>
								<input type="radio" id="male" name="sex" value="male" checked>
								Male
							</label>
						</div>
						<div>
							<label>
								<input type="radio" id="female" name="sex" value="female" checked>
								Female
							</label>
							<!-- <label for="female">Female</label> -->
						</div>
					</div>
					<button type="button" value="Submit" id="submit" />Calculate</button>
				</form>
				<div class="display-result" id="displayResult">
					<h4 id="imcNumber"></h4>
					<h4 id="imcString"></h4>
				</div>
				<div class="index-down-btn">
					<a href="/index.html">
						<button class="down-btn">Go Back</button>
					</a>
				</div>
			</div>
		</div>
	</div>
	<script>
		const submit = document.getElementById('submit');
		const displayResult = document.getElementById('displayResult');

		submit.addEventListener('click', () => {
			imc();
		});

		async function imc() {

			const height = document.getElementById('height').value;
			const weight = document.getElementById('weight').value;
			const age = document.getElementById('age').value;
			const sex = document.querySelector('input[name="sex"]:checked').value;

			console.log(height, weight, age, sex);

			const result = await fetch("/api/calories", {
				method: "POST",
				headers: {
					"Content-Type": "application/json",
				},
				body: JSON.stringify({
					age: age,
					weight: weight,
					height: height,
					gender: sex,
				})
			})

			const data = await result.json();
			const total = parseFloat(data.total).toFixed(2);
			console.log(total);
			var totalCategory = undefined;

			switch (true) {
				case (total < 18.50):
					totalCategory = "Under weight"
					displayResult.classList.remove("green");
					displayResult.classList.remove("red");
					displayResult.classList.remove("blue");
					displayResult.classList.remove("yellow");
					displayResult.classList.add("blue");
					break;
				case ((total >= 18.50) && (total < 24.99)):
					totalCategory = "Normal"
					displayResult.classList.remove("green");
					displayResult.classList.remove("red");
					displayResult.classList.remove("blue");
					displayResult.classList.remove("yellow");
					displayResult.classList.add("green");
					break;
				case ((total >= 24.99) && (total < 29.99)):
					totalCategory = "Over weight"
					displayResult.classList.remove("green");
					displayResult.classList.remove("red");
					displayResult.classList.remove("blue");
					displayResult.classList.remove("yellow");
					displayResult.classList.add("yellow");
					break;
				case ((total >= 29.99) && (total < 34.99)):
					totalCategory = "Obesity I"
					displayResult.classList.remove("green");
					displayResult.classList.remove("red");
					displayResult.classList.remove("blue");
					displayResult.classList.remove("yellow");
					displayResult.classList.add("red");
					break;
				case ((total >= 34.99) && (total < 39.99)):
					totalCategory = "Obesity II"
					displayResult.classList.remove("green");
					displayResult.classList.remove("red");
					displayResult.classList.remove("blue");
					displayResult.classList.remove("yellow");
					displayResult.classList.add("red");
					break;
				case (total >= 39.99):
					totalCategory = "Obesity III"
					displayResult.classList.remove("green");
					displayResult.classList.remove("red");
					displayResult.classList.remove("blue");
					displayResult.classList.remove("yellow");
					displayResult.classList.add("red");
					break;
				default:
					totalCategory = "Error"
					displayResult.classList.remove("green");
					displayResult.classList.remove("red");
					displayResult.classList.remove("blue");
					displayResult.classList.remove("yellow");
					displayResult.classList.add("red");
			}
			document.getElementById("imcNumber").innerHTML = total
			document.getElementById("imcString").innerHTML = totalCategory
		}

	</script>
	<!-- ------------------------SCRIPTS------------------------ -->
	<script src="../vendor/jquery/jquery-3.2.1.min.js"></script>

	<script src="../vendor/bootstrap/js/popper.js"></script>
	<script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

	<script src="../vendor/select2/select2.min.js"></script>

	<script src="../vendor/tilt/tilt.jquery.min.js"></script>
	<script>
		$('.js-tilt').tilt({
			scale: 1.1
		})
	</script>

	<script src="../js/main.js"></script>

</body>

</html>